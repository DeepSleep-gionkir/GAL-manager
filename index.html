<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°¤ëŸ¬ë¦¬ ì‚´ë¦¬ê¸° ì‹œë®¬ë ˆì´í„° DX</title>
    <style>
        :root {
            --bg-color: #2d3436;
            --text-color: #dfe6e9;
            --accent-color: #0984e3;
            --danger-color: #d63031;
            --warning-color: #fdcb6e;
            --success-color: #00b894;
            --mental-color: #a29bfe;
        }

        body {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            box-sizing: border-box;
            -webkit-user-select: none;
            user-select: none;
        }

        .container {
            width: 100%;
            max-width: 650px;
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #636e72;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        h1 {
            text-align: center;
            font-size: 1.5rem;
            margin: 0 0 15px 0;
            color: #fff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        /* Stats Bars */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        @media (max-width: 500px) {
            .stats-grid { grid-template-columns: 1fr; gap: 5px; }
        }

        .status-bar { margin-bottom: 5px; }
        .status-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 3px;
            font-size: 0.85rem;
            font-weight: bold;
        }
        .bar-container {
            height: 12px;
            background-color: #444;
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }
        .bar-fill {
            height: 100%;
            width: 50%;
            transition: width 0.4s cubic-bezier(0.25, 1, 0.5, 1), background-color 0.4s;
        }

        /* Log Area */
        #game-log {
            background-color: #111;
            color: #0f0;
            font-family: 'D2Coding', 'Courier New', monospace;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 15px;
            overflow-y: auto;
            font-size: 13px;
            line-height: 1.4;
            border: 1px solid #555;
            height: 180px;
            flex-shrink: 0;
            box-shadow: inset 0 0 10px #000;
        }
        .log-entry { margin-bottom: 6px; border-bottom: 1px dashed #333; padding-bottom: 2px; }
        .log-day { color: #ffeaa7; font-weight: bold; }
        .log-bad { color: #ff7675; }
        .log-good { color: #55efc4; }
        .log-info { color: #74b9ff; }

        /* Action Grid */
        .actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        button {
            padding: 12px 5px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.1s;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
            min-height: 60px;
        }

        button:active { transform: translateY(2px); box-shadow: 0 2px 0 rgba(0,0,0,0.2); }
        button:disabled { opacity: 0.4; cursor: not-allowed; filter: grayscale(100%); }

        .btn-blue { background-color: var(--accent-color); }
        .btn-red { background-color: var(--danger-color); }
        .btn-yellow { background-color: #e67e22; }
        .btn-purple { background-color: #6c5ce7; }
        .btn-green { background-color: var(--success-color); }
        .btn-dark { background-color: #636e72; }

        .tooltip {
            font-size: 0.7rem;
            color: rgba(255,255,255,0.8);
            margin-top: 3px;
            font-weight: normal;
        }

        /* Overlay */
        #overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.96);
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 999;
            text-align: center;
            padding: 20px;
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; }}

        #ending-title { font-size: 2.2rem; margin-bottom: 15px; font-weight: 900; }
        #ending-desc { font-size: 1.1rem; margin-bottom: 30px; line-height: 1.6; color: #dfe6e9; max-width: 500px;}
        #restart-btn {
            background-color: var(--success-color);
            padding: 15px 40px;
            font-size: 1.3rem;
            box-shadow: 0 5px 0 #008c70;
        }

        /* Badge */
        .badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.7rem;
            margin-left: 5px;
        }
        .badge-pasdak { background-color: #0984e3; color: white; }
    </style>
</head>
<body>

    <div class="container">
        <h1>ğŸ“Š ë§ˆì´ë„ˆ ê°¤ëŸ¬ë¦¬ ë§¤ë‹ˆì € DX</h1>

        <div class="stats-grid">
            <div>
                <div class="status-bar">
                    <div class="status-label">
                        <span>ğŸ“… ìƒì¡´: <span id="day-display">1</span>/60ì¼</span>
                        <span id="pasdak-badge" class="badge badge-pasdak" style="display:none;">íŒŒë”± ë³´ìœ ì¤‘</span>
                    </div>
                    <div class="bar-container" style="background:#222;">
                        <div id="progress-bar" class="bar-fill" style="width: 1%; background-color: #fff;"></div>
                    </div>
                </div>

                <div class="status-bar">
                    <div class="status-label">
                        <span>ğŸ”¥ í™œì„±ë„ (ë¦¬ì  )</span>
                        <span id="val-activity">50</span>
                    </div>
                    <div class="bar-container">
                        <div id="activity-bar" class="bar-fill" style="width: 50%; background-color: #00b894;"></div>
                    </div>
                </div>
                
                <div class="status-bar">
                    <div class="status-label">
                        <span>ğŸ§  ì£¼ë”± ë©˜íƒˆ</span>
                        <span id="val-mental">100</span>
                    </div>
                    <div class="bar-container">
                        <div id="mental-bar" class="bar-fill" style="width: 100%; background-color: #a29bfe;"></div>
                    </div>
                </div>
            </div>

            <div>
                <div class="status-bar">
                    <div class="status-label">
                        <span>ğŸ¤¬ ì–´ê·¸ë¡œ/ë¶„íƒ•</span>
                        <span id="val-toxicity">20</span>
                    </div>
                    <div class="bar-container">
                        <div id="toxicity-bar" class="bar-fill" style="width: 20%; background-color: #fdcb6e;"></div>
                    </div>
                </div>

                <div class="status-bar">
                    <div class="status-label">
                        <span>ğŸ¤ ì¹œëª©ì§ˆ (ìœ„í—˜)</span>
                        <span id="val-friendship">10</span>
                    </div>
                    <div class="bar-container">
                        <div id="friendship-bar" class="bar-fill" style="width: 10%; background-color: #74b9ff;"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="game-log">
            <div class="log-entry">> ê°¤ëŸ¬ë¦¬ê°€ ê°œì„¤ë˜ì—ˆìŠµë‹ˆë‹¤. 60ì¼ì„ ë²„í‹°ì‹­ì‹œì˜¤.</div>
            <div class="log-entry">> ë©˜íƒˆì´ 0ì´ ë˜ê±°ë‚˜, ë‹¤ë¥¸ ìŠ¤íƒ¯ì´ 100/0ì´ ë˜ë©´ ë§í•©ë‹ˆë‹¤.</div>
        </div>

        <div class="actions">
            <button class="btn-blue" onclick="game.action('promote')">
                ğŸ“¡ íƒ€ê°¤ í™ë³´
                <span class="tooltip">í™œì„±â†‘ ì–´ê·¸ë¡œâ†‘ ë©˜íƒˆ-5</span>
            </button>
            <button class="btn-red" onclick="game.action('censorship')">
                ğŸ”¨ ì²œì•ˆë¬¸ (ê´‘ì—­ì‚­ì œ)
                <span class="tooltip">ì–´ê·¸ë¡œâ†“â†“â†“ í™œì„±â†“ ë©˜íƒˆ-20</span>
            </button>
            <button class="btn-yellow" onclick="game.action('bait')">
                ğŸ”¥ ë–¡ë°¥ êµ´ë¦¬ê¸°
                <span class="tooltip">í™œì„±â†‘â†‘ ì¹œëª©â†“ ì–´ê·¸ë¡œâ†‘ ë©˜íƒˆ-5</span>
            </button>
            <button class="btn-purple" onclick="game.action('info')">
                ğŸ“˜ ì •ë³´ê¸€/ê³µì§€ ì‘ì„±
                <span class="tooltip">ì–´ê·¸ë¡œâ†“ í™œì„±+ ë©˜íƒˆ-10</span>
            </button>
            
            <button class="btn-green" onclick="game.action('contest')">
                ğŸ† ëŒ€íšŒ ê°œìµœ
                <span class="tooltip">í™œì„±â†‘â†‘ ì¹œëª©â†‘â†‘ ë©˜íƒˆ-15</span>
            </button>
            <button class="btn-dark" onclick="game.action('recruit')">
                ğŸ‘®â€â™‚ï¸ íŒŒë”±(ë¶€ë§¤ë‹ˆì €) í˜¸ì¶œ
                <span class="tooltip">ìë™ê´€ë¦¬ / í†µìˆ˜ìœ„í—˜</span>
            </button>
            <button class="btn-red" onclick="game.action('shame')">
                ğŸ”« ê³ ë¡œì‹œ (ì €ê²©)
                <span class="tooltip">ì¹œëª©â†“â†“ ì–´ê·¸ë¡œâ†‘ ë©˜íƒˆ-10</span>
            </button>
            <button class="btn-green" onclick="game.action('rest')">
                ğŸ›Œ í˜„ìƒ ì‚´ê¸° (íœ´ì‹)
                <span class="tooltip">ë©˜íƒˆíšŒë³µâ†‘â†‘ ê°¤ë°©ì¹˜(ëœë¤)</span>
            </button>
            
            <button class="btn-blue" onclick="game.action('alliance')">
                ğŸ¤ íƒ€ê°¤ê³¼ ë™ë§¹
                <span class="tooltip">í™œì„±â†‘â†‘ ì–´ê·¸ë¡œâ†‘â†‘ ë©˜íƒˆ-10</span>
            </button>
            <button class="btn-yellow" onclick="game.action('allow_friend')">
                ğŸ¥‚ ì¢†ëª© í—ˆìš©
                <span class="tooltip">ì¹œëª©â†‘â†‘â†‘ í™œì„±â†‘ ë©˜íƒˆ+5</span>
            </button>
        </div>
    </div>

    <div id="overlay">
        <h2 id="ending-title">GAME OVER</h2>
        <p id="ending-desc">ì—”ë”© ì„¤ëª…ì´ ì—¬ê¸°ì— ë‚˜ì˜µë‹ˆë‹¤.</p>
        <button id="restart-btn" onclick="game.reset()">ë‹¤ì‹œ ê³ í†µë°›ê¸°</button>
    </div>

<script>
    class GallerySim {
        constructor() {
            this.maxDays = 60;
            this.reset();
        }

        reset() {
            this.state = {
                day: 1,
                activity: 40,    // 0~100
                toxicity: 10,    // 0~100
                friendship: 5,   // 0~100
                mental: 100,     // 0~100 (0=Game Over)
                hasPasdak: false,
                pasdakTrust: 50, // íŒŒë”± ì‹ ë¢°ë„ (ë‚®ìœ¼ë©´ ì¿ ë°íƒ€)
                isGameOver: false
            };
            this.ui = {
                log: document.getElementById('game-log'),
                day: document.getElementById('day-display'),
                overlay: document.getElementById('overlay'),
                endingTitle: document.getElementById('ending-title'),
                endingDesc: document.getElementById('ending-desc'),
                pasdakBadge: document.getElementById('pasdak-badge')
            };
            this.ui.overlay.style.display = 'none';
            this.ui.log.innerHTML = '<div class="log-entry">> ê°¤ëŸ¬ë¦¬ ì¬ê°œì¥. ì´ë²ˆì—” ì œë°œ...</div>';
            this.updateUI();
        }

        // ìœ í‹¸ë¦¬í‹°
        r(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }
        clamp(val) { return Math.max(0, Math.min(100, val)); }

        // ë¡œê·¸ ì¶œë ¥
        log(msg, type = 'normal') {
            const div = document.createElement('div');
            div.className = 'log-entry';
            if (type === 'bad') div.classList.add('log-bad');
            if (type === 'good') div.classList.add('log-good');
            if (type === 'info') div.classList.add('log-info');
            div.innerHTML = `<span class="log-day">[Day ${this.state.day}]</span> ${msg}`;
            this.ui.log.appendChild(div);
            this.ui.log.scrollTop = this.ui.log.scrollHeight;
        }

        // ìƒíƒœ ë³€ê²½
        apply(act, tox, fri, men) {
            // íŒŒë”±ì´ ìˆìœ¼ë©´ ì–´ê·¸ë¡œ ìë™ ê°ì†Œ ë³´ë„ˆìŠ¤, ëŒ€ì‹  í™œì„±ë„ ì•½ê°„ ê°ì†Œ (ì§„ì••)
            if (this.state.hasPasdak) {
                tox -= 5;
                act -= 2;
                // íŒŒë”± ì‹ ë¢°ë„ ë³€í™”
                if (tox > 70) this.state.pasdakTrust -= 5; // ê°¤ ë”ëŸ¬ìš°ë©´ íŒŒë”± ë©˜íƒˆ ë‚˜ê°
            }

            this.state.activity = this.clamp(this.state.activity + act);
            this.state.toxicity = this.clamp(this.state.toxicity + tox);
            this.state.friendship = this.clamp(this.state.friendship + fri);
            this.state.mental = this.clamp(this.state.mental + men);
        }

        // í–‰ë™ ë¡œì§
        action(type) {
            if (this.state.isGameOver) return;

            let msg = "";
            let s = { a:0, t:0, f:0, m:0 }; // changes

            switch(type) {
                case 'promote':
                    s.a = this.r(10, 20); s.t = this.r(5, 15); s.m = -5;
                    msg = "ì•¼ê°¤/ì‹¤ë² ì— í™ë³´ë¥¼ ëŒë ¸ìŠµë‹ˆë‹¤. ìœ ì…ì´ ëŠ˜ì–´ë‚©ë‹ˆë‹¤.";
                    break;
                case 'censorship':
                    s.a = this.r(-15, -5); s.t = this.r(-30, -20); s.m = -20;
                    msg = "ì™„ì¥ì´ ë¯¸ì³ ë‚ ë›°ê³  ìˆìŠµë‹ˆë‹¤! ê¸€ì„ ë‹¥ì¹˜ëŠ”ëŒ€ë¡œ ì‚­ì œí•©ë‹ˆë‹¤.";
                    break;
                case 'bait':
                    s.a = this.r(15, 25); s.t = this.r(15, 25); s.f = -5; s.m = -5;
                    msg = "ì‹¸ì›€ ë‚ ë§Œí•œ ë–¡ë°¥ì„ ë˜ì¡ŒìŠµë‹ˆë‹¤. ëŒ“ê¸€ì°½ì´ ë¶ˆíƒ‘ë‹ˆë‹¤.";
                    break;
                case 'info':
                    s.a = this.r(5, 10); s.t = this.r(-10, -5); s.f = 2; s.m = -10;
                    msg = "ì •ì„±ìŠ¤ëŸ¬ìš´ ê³µì§€ê¸€ì„ ì¼ìŠµë‹ˆë‹¤. ì ì‹œ ê°¤ì´ ì •í™”ë©ë‹ˆë‹¤.";
                    break;
                case 'contest':
                    s.a = this.r(20, 30); s.t = this.r(-5, 5); s.f = 15; s.m = -15;
                    msg = "ì¹˜í‚¨ ê±¸ê³  ëŒ€íšŒë¥¼ ì—´ì—ˆìŠµë‹ˆë‹¤. ì¢†ëª©ë¼ì¸ì´ í˜•ì„±ë  ì¡°ì§ì´ ë³´ì…ë‹ˆë‹¤.";
                    break;
                case 'recruit':
                    if (this.state.hasPasdak) {
                        msg = "ì´ë¯¸ íŒŒë”±ì´ ìˆìŠµë‹ˆë‹¤. (í•´ì„ ê¸°ëŠ¥ ë¯¸êµ¬í˜„ - íŒŒë”±ì€ ì¢…ì‹ ì…ë‹ˆë‹¤)";
                        s.m = -5;
                    } else {
                        this.state.hasPasdak = true;
                        this.state.pasdakTrust = 70;
                        s.m = 10; // ë©˜íƒˆ íšŒë³µ
                        msg = "ë…¸ì˜ˆ(íŒŒë”±)ë¥¼ í•œ ëª… ë‚©ì¹˜í–ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ê°€ ìˆ˜ì›”í•´ì§‘ë‹ˆë‹¤.";
                    }
                    break;
                case 'shame': // ê³ ë¡œì‹œ
                    s.a = 5; s.t = 10; s.f = -20; s.m = -10;
                    msg = "íŠ¹ì • ê³ ë‹‰ì„ ë°•ì œí•˜ê³  ê³ ë¡œì‹œí–ˆìŠµë‹ˆë‹¤. ì¹œëª©ì§ˆì´ ì¤„ì–´ë“­ë‹ˆë‹¤.";
                    break;
                case 'rest':
                    s.a = this.r(-10, 5); s.t = this.r(-5, 15); s.m = 30;
                    msg = "ê°¤ì„ ë„ê³  í˜„ìƒì„ ì‚´ëŸ¬ ê°”ìŠµë‹ˆë‹¤. ê°¤ ê´€ë¦¬ëŠ” ìš´ì— ë§¡ê¹ë‹ˆë‹¤.";
                    break;
                case 'alliance':
                    s.a = 25; s.t = 25; s.m = -10;
                    msg = "ì˜† ê°¤ëŸ¬ë¦¬ì™€ ë™ë§¹ì„ ë§ºì—ˆìŠµë‹ˆë‹¤. ì„œë¡œ ëª°ë ¤ì™€ì„œ ë‚œì¥íŒì´ ë©ë‹ˆë‹¤.";
                    break;
                case 'allow_friend':
                    s.a = 5; s.f = 25; s.m = 5;
                    msg = "ì˜¤í”„ë¼ì¸ ì •ëª¨ ì‚¬ì§„ì„ ê°œë…ê¸€ì— ì˜¬ë ¸ìŠµë‹ˆë‹¤. ê·¸ë“¤ë§Œì˜ ë¦¬ê·¸ ì‹œì‘.";
                    break;
            }

            this.apply(s.a, s.t, s.f, s.m);
            this.log(msg);

            // íŒŒë”± ì´ë²¤íŠ¸
            if (this.state.hasPasdak) {
                if (Math.random() < 0.2) {
                    this.state.pasdakTrust -= 10;
                    this.log("íŒŒë”±ì´ í˜ì§¤ì„ ì§€ìš°ë‹¤ ë©˜íƒˆì´ ë‚˜ê°”ìŠµë‹ˆë‹¤.", "info");
                }
            }

            this.randomEvent();
            this.checkEnding();
            
            if (!this.state.isGameOver) {
                this.state.day++;
                this.updateUI();
            }
        }

        randomEvent() {
            if (Math.random() > 0.4) return; // 40% í™•ë¥ 

            const roll = Math.random();
            if (roll < 0.1) {
                this.log("ğŸš¨ ì‹¤ì‹œê°„ ë² ìŠ¤íŠ¸(ì‹¤ë² )ì— ë°•ì œë˜ì—ˆìŠµë‹ˆë‹¤! ì•Œë°” ì”¹ìƒˆë¼!", "bad");
                this.apply(30, 30, 0, -10);
            } else if (roll < 0.2) {
                this.log("ğŸ“‰ ì„œë²„ ì˜¤ë¥˜ë¡œ ê¸€ ì‘ì„±ì´ ì•ˆë©ë‹ˆë‹¤.", "bad");
                this.apply(-20, -10, 0, 0);
            } else if (roll < 0.3) {
                this.log("ğŸ•µï¸â€â™‚ï¸ ê³ ì†Œí•˜ê² ë‹¤ëŠ” ìœ ì…ì´ ë“±ì¥í–ˆìŠµë‹ˆë‹¤.", "bad");
                this.apply(0, 10, 0, -20);
            } else if (roll < 0.4) {
                this.log("ğŸ¨ ì¡´ì˜ëŸ¬ê°€ ì§¤ì„ ê·¸ë ¤ì™”ìŠµë‹ˆë‹¤.", "good");
                this.apply(10, -10, 5, 5);
            } else if (roll < 0.5) {
                 this.log("ğŸš‘ ë¶„íƒ•ì´ í• ì¹´ìŠ¤ë¥¼ ë‹¬ë ¸ìŠµë‹ˆë‹¤!! ëˆˆê°±!", "bad");
                 this.apply(0, 20, 0, -30);
            }
        }

        checkEnding() {
            const { activity, toxicity, friendship, mental, day, hasPasdak, pasdakTrust } = this.state;

            // 1. ë©˜íƒˆ ë¶•ê´´
            if (mental <= 0) {
                this.endGame("ğŸš‘ ì •ì‹ ë³‘ì› ì—”ë”©", "ì£¼ë”±ì˜ ë©˜íƒˆì´ ë°”ì‚¬ì‚­ ë¶€ì„œì¡ŒìŠµë‹ˆë‹¤.<br>ë‹¹ì‹ ì€ ê°¤ëŸ¬ë¦¬ë¥¼ ë²„ë¦¬ê³  ìš”ì–‘ì„ ë– ë‚¬ìŠµë‹ˆë‹¤.");
                return;
            }

            // 2. íŒŒë”± ì¿ ë°íƒ€ (íŒŒë”± ìˆìŒ + ì‹ ë¢°ë„ ë°”ë‹¥ + ì–´ê·¸ë¡œ ë†’ìŒ)
            if (hasPasdak && pasdakTrust <= 0) {
                this.endGame("ğŸ”ª íŒŒë”±ì˜ ë°˜ë€", "íŒŒë”±ì´ ì£¼ë”±ì˜ ì§ë¬´ìœ ê¸°ë¥¼ ê³ ë°œí•˜ê³  ë§¤ë‹ˆì € ìœ„ì„ ì‹ ì²­ì„ í–ˆìŠµë‹ˆë‹¤.<br>ê°¤ì£¼ê°€ êµì²´ë˜ì—ˆìŠµë‹ˆë‹¤.");
                return;
            }

            // 3. ì •ì „ê°¤ (í™œë™ 0)
            if (activity <= 0) {
                this.endGame("â„ï¸ ì—ë² ë ˆìŠ¤íŠ¸ ì—”ë”©", "ê¸€ ë¦¬ì  ì´ ë©ˆì·„ìŠµë‹ˆë‹¤.<br>ë„ˆë¬´ ì¶”ì›Œì„œ ì•„ë¬´ë„ ì‚´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                return;
            }

            // 4. í­íŒŒ (ì–´ê·¸ë¡œ 100)
            if (toxicity >= 100) {
                this.endGame("ğŸ’£ ì ‘ê·¼ ì œí•œ ì—”ë”©", "ìŒë€ë¬¼ ë° ê¶Œë¦¬ ì¹¨í•´ ê²Œì‹œë¬¼ í­ì£¼.<br>ìš´ì˜ì •ì±… ìœ„ë°˜ìœ¼ë¡œ ê°¤ëŸ¬ë¦¬ê°€ íì‡„ë˜ì—ˆìŠµë‹ˆë‹¤.");
                return;
            }

            // 5. ì¢†ëª© (ì¹œëª© 100)
            if (friendship >= 100) {
                this.endGame("ğŸ¤® ì—¬ì™•ë²Œ ì—”ë”©", "ë„¤ì„ë“œ ìœ ì €ì™€ ê·¸ ì¶”ì¢…ìë“¤ì´ ê°¤ì„ ì ë ¹í–ˆìŠµë‹ˆë‹¤.<br>ë‰´ë¹„ë“¤ì€ ë°°ì²™ë‹¹í•´ ëª¨ë‘ ë– ë‚¬ìŠµë‹ˆë‹¤.");
                return;
            }

            // 6. ì‹ë¬¼ê°¤ (ì–´ê·¸ë¡œ 0, í™œë™ < 30)
            if (toxicity <= 0 && activity < 30) {
                this.endGame("ğŸ§˜ ì„ ë¹„ ì—”ë”©", "ë„ˆë¬´ ì—„ê²©í•œ ê·œì •ì— ìˆ¨ì´ ë§‰í™ë‹ˆë‹¤.<br>ë…¸ì¼ì´ë¼ ë‹¤ë“¤ ë– ë‚¬ìŠµë‹ˆë‹¤.");
                return;
            }

            // 7. ì‹¤ë¶ê°¤ ì‹ë¯¼ì§€ (í™œë™ 100, ì–´ê·¸ë¡œ > 80)
            if (activity >= 100 && toxicity > 80) {
                this.endGame("ğŸ§Ÿâ€â™‚ï¸ ì•¼ê°¤ ì‹ë¯¼ì§€ ì—”ë”©", "ê°ë‹¹í•  ìˆ˜ ì—†ëŠ” ìœ ì…ì´ ë“¤ì´ë‹¥ì³¤ìŠµë‹ˆë‹¤.<br>ê°¤ëŸ¬ë¦¬ì˜ ì •ì²´ì„±ì€ ì‚¬ë¼ì§€ê³  ë˜¥ê¸€ë§Œ ë‚¨ì•˜ìŠµë‹ˆë‹¤.");
                return;
            }

            // ìŠ¹ë¦¬ ì¡°ê±´
            if (day > this.maxDays) {
                // ì§„ì—”ë”© ë¶„ê¸°
                if (activity > 80 && toxicity < 50) {
                    this.endGame("ğŸ† ë©”ì´ì € ê°¤ëŸ¬ë¦¬ ìŠ¹ê²©", "ì¶•í•˜í•©ë‹ˆë‹¤! ì—„ì²­ë‚œ í™œì„±ë„ì™€ í´ë¦°í•œ ê´€ë¦¬.<br>ë””ì‹œì¸ì‚¬ì´ë“œ ê³µì‹ ê°¤ëŸ¬ë¦¬ë¡œ ìŠ¹ê²©ë˜ì—ˆìŠµë‹ˆë‹¤.", "#ffd700");
                } else if (friendship > 60) {
                    this.endGame("ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ëŒ€ê°€ì¡± ì—”ë”©", "ë¹„ë¡ ì¢†ëª©ì§ˆì´ë¼ ìš•ë¨¹ì§€ë§Œ...<br>ìš°ë¦¬ëŠ” ê°€ì¡±ì´ ë˜ì—ˆìŠµë‹ˆë‹¤. í–‰ë³µí•˜ë©´ ëì§€.", "#74b9ff");
                } else {
                    this.endGame("ğŸ—¿ ìƒì¡´ì™• ì—”ë”©", "ì–´ë–»ê²Œë“  60ì¼ì„ ë²„í…¼ìŠµë‹ˆë‹¤.<br>í•˜ì§€ë§Œ ë‚´ì¼ë„ ë˜¥ì„ ì¹˜ì›Œì•¼ í•©ë‹ˆë‹¤.", "#55efc4");
                }
            }
        }

        endGame(title, desc, color = null) {
            this.state.isGameOver = true;
            this.ui.endingTitle.innerText = title;
            this.ui.endingDesc.innerHTML = desc;
            if (color) this.ui.endingTitle.style.color = color;
            else this.ui.endingTitle.style.color = "#d63031";
            this.ui.overlay.style.display = 'flex';
        }

        updateUI() {
            this.ui.day.innerText = this.state.day;
            this.ui.pasdakBadge.style.display = this.state.hasPasdak ? 'inline-block' : 'none';

            // ë°” ì—…ë°ì´íŠ¸
            this.setBar('activity-bar', this.state.activity, 'val-activity', false);
            this.setBar('toxicity-bar', this.state.toxicity, 'val-toxicity', true);
            this.setBar('friendship-bar', this.state.friendship, 'val-friendship', true);
            this.setBar('mental-bar', this.state.mental, 'val-mental', false);
            
            // ìƒë‹¨ ì§„í–‰ë°”
            document.getElementById('progress-bar').style.width = (this.state.day / this.maxDays * 100) + '%';
        }

        setBar(id, val, textId, isBadHigh) {
            const el = document.getElementById(id);
            const txt = document.getElementById(textId);
            el.style.width = val + '%';
            txt.innerText = val;

            // ìƒ‰ìƒ ë¡œì§
            if (id === 'mental-bar') {
                el.style.backgroundColor = val < 30 ? '#d63031' : '#a29bfe';
            } else if (isBadHigh) {
                 el.style.backgroundColor = val > 80 ? '#d63031' : (val > 50 ? '#fdcb6e' : '#00b894');
            } else {
                 el.style.backgroundColor = val < 20 ? '#d63031' : (val < 50 ? '#fdcb6e' : '#00b894');
            }
        }
    }

    const game = new GallerySim();

</script>
</body>
</html>
